# Invoice Exporter для 1C 7.7

Автоматическая система экспорта расходных накладных из 1C 7.7 в PDF формат.

## Описание

Приложение автоматически извлекает данные расходных накладных напрямую из DBF файлов базы данных 1C 7.7 и генерирует PDF документы с профессиональной вёрсткой.

### Основные возможности

- ✅ **Прямое чтение DBF** — не требует запущенной 1C, работает напрямую с файлами базы
- ✅ **Автоопределение структуры** — автоматически находит нужные таблицы и поля
- ✅ **Универсальность** — работает с любыми конфигурациями 1C 7.7
- ✅ **Компактная печать** — 3 накладные на странице A4
- ✅ **Интерактивный интерфейс** — удобное меню с выбором дат
- ✅ **Русская локализация** — полная поддержка кириллицы, сумма прописью

## Системные требования

- **ОС**: Windows 7 SP1 или выше
- **Python**: 3.8.10 (32-bit)
- **1C**: Enterprise 7.7.25 (база данных в формате DBF)

## Установка

1. Клонируйте репозиторий:
```bash
git clone https://github.com/Limonchik/invoice_pdf_exporter.git
cd invoices
```

2. Установите зависимости:
```bash
pip install -r requirements.txt
```

3. Настройте путь к базе данных в `config.py`:
```python
DB_PATH = r"\\server\path\to\1c\database"
```

## Использование

Запустите приложение:
```bash
python main.py
```

Выберите нужную опцию из меню:
1. **Экспорт за сегодня** — все накладные за текущую дату
2. **Экспорт за дату** — накладные за конкретную дату
3. **Экспорт за период** — накладные за диапазон дат
4. **Настройки** — изменение параметров
5. **Выход**

PDF файлы сохраняются в папку `output/`.

## Структура проекта

```
invoice_exporter/
├── config.py              # Настройки подключения и путей
├── main.py                # Главное меню и точка входа
├── requirements.txt       # Зависимости Python
├── modules/               # Основные модули
│   ├── dbf_reader.py     # Чтение DBF с автоопределением
│   ├── invoice_extractor.py  # Извлечение данных накладных
│   ├── pdf_generator.py  # Генерация PDF
│   └── utils.py          # Вспомогательные функции
├── styles/                # Стили для PDF
│   └── table_styles.py
├── fonts/                 # Шрифты с поддержкой кириллицы
├── logs/                  # Логи выполнения
└── output/                # Сгенерированные PDF
```

## Технологии

- **dbfread** — чтение DBF файлов
- **ReportLab** — генерация PDF с точным позиционированием
- **num2words** — преобразование суммы в текст (прописью)
- **rich** — интерактивный терминальный интерфейс

## Особенности реализации

### Автоопределение структуры БД
Приложение анализирует журнал документов (`1SJOURN.DBF`) и автоматически определяет:
- Файлы с расходными накладными (DH*.DBF, DT*.DBF)
- Справочники товаров и единиц измерения
- Необходимые поля данных

### Формат PDF
- Размер страницы: A4 (портрет)
- Накладных на странице: 3 шт.
- Стиль таблиц: Excel-like с чередующимися строками
- Кодировка: Windows-1251 (cp1251) для корректного отображения кириллицы

## Лицензия

Proprietary — для внутреннего использования.

## Автор

Разработано для автоматизации работы с документами 1C 7.7.
